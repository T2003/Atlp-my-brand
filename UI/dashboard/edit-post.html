<!DOCTYPE html>

<html lang="en" dir="ltr">
  <head>
    <meta charset="UTF-8">
    <title> D-Designer | Dashboard </title>
    <link rel="stylesheet" href="style.css">
 
    <link href='https://unpkg.com/boxicons@2.0.7/css/boxicons.min.css' rel='stylesheet'>
     <meta name="viewport" content="width=device-width, initial-scale=1.0">
   </head>
<body>
  <div class="sidebar">
    <div class="logo-details">
        <i class='bx bx-user-circle' title="D-Designer"></i>
      <span class="logo_name">D-Designer</span>
    </div>
      <ul class="nav-links">
        <li>
          <a href="admin.html" class="active">
            <i class='bx bx-grid-alt' ></i>
            <span class="links_name">Dashboard</span>
          </a>
        </li>
        
        <li>
            <a href="new-post.html">
              <i class='bx bx-add-to-queue' ></i>
              <span class="links_name">New Post</span>
            </a>
          </li>
        <li>
          <a href="view-post.html">
            <i class='bx bx-show-alt' ></i>
            <span class="links_name">View post</span>
          </a>
        </li>
        <li>
          <a href="message.html">
            <i class='bx bx-message-detail' ></i>
            <span class="links_name">Messages</span>
          </a>
        </li>
        
        <li class="log_out">
          <a href="#" id="logoutBtn"><i class='bx bx-log-out' title="logout" 
            style="cursor: pointer;"></i>
            <span class="links_name">Log out</span></a>
        </li>
      </ul>
  </div>
  <section class="home-section">
    <nav>
      <div class="sidebar-button">
        <i class='bx bx-menu sidebarBtn'></i>
        <span class="dashboard"></span>
      </div>
      <div class="">
        <h2>Update Post</h2>
      </div>
      <div class="profile-details">
        <img src="assets/img/e.jpg" alt="">
        <span class="admin_name">Daniel T</span>
        
        <a href="#" id="logoutBtn"><i class='bx bx-log-out' title="logout" style="cursor: pointer;"></i></a>
      </div>
    </nav>

    <div class="home-content">
      
      <div class="sales-boxes">
        <div class="recent-sales box">
          <div class="title"><h2>Edit your post</h2></div><br>
          <form action="">
            <div class="content">
              <div class="article-form">
                
                  <h4>Title</h4>
                  <input type="text" placeholder="  Web Design" class="form" style=" 
                  box-shadow: 3px 4px 5px 0px;  height: 1cm; width: 7cm;"><br><br>
                  <img src="assets/img/e.jpg" alt="" style="width: 2cm; border-radius: 10px; margin-top: -0.2cm;">
                  <h4>Update cover photo</h4>
                  <input type="file" ><br><br>
                  <h4>Body</h4>
                  <textarea
                    type="text"
                    placeholder="  Iâ€™m Daniel [D-Designer] working on  Grapphic Design, 
                    Web Design, Web Re-design, Apps building, Illustrations,
                     Videographer, Photographer and Editing. 

                   "
                     rows="8" style=" 
                     box-shadow: 3px 4px 5px 0px; width: 7cm; text-align: justify;"                  ></textarea><br><br>
                  
                
              </div>
            </div>
            <div class="button">
                <a href="#">Update</a>
              </div>
        </form>
        </div>
        <div class="top-sales box">
            <div class="title"><h3>Tags</h3></div>
            <ul class="top-sales-details">
              <li>
              <a href="#">
                
                <span class="product">- Tech</span>
              </a>
            </li>
            <li>
              <a href="#">
                <span class="product">- Business</span>
              </a>
            
            </li>
            <li>
              <a href="#">
                <span class="product">- Life Experience</span>
              </a>
            </li>
            <li>
                <a href="#">
                  <span class="product">- Football</span>
                </a>
              </li>
            
            </ul>
          </div>
      </div>
    </div>
  </section> -->
  
  <script>
   let sidebar = document.querySelector(".sidebar");
let sidebarBtn = document.querySelector(".sidebarBtn");
sidebarBtn.onclick = function() {
  sidebar.classList.toggle("active");
  if(sidebar.classList.contains("active")){
  sidebarBtn.classList.replace("bx-menu" ,"bx-menu-alt-right");
}else
  sidebarBtn.classList.replace("bx-menu-alt-right", "bx-menu");
}
 </script>
 <script src="./javascript.js"></script>
 <script src="./assets/ckeditor.js"></script>
 <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
 <script>
   const user = JSON.parse(localStorage.getItem('loginedUser'))
   

   if (localStorage.getItem("updateArticle")) {
     let article = JSON.parse(localStorage.getItem("updateArticle"));

     document.getElementById("cover").style.display = "none";
     document.getElementById("submitBtn").value = "UPDATE";

     document.getElementById("title").value = article.title;
     document.getElementById("body").value = article.content;
     // document.getElementById("tag").value = article.tag;
     // var articleId = article.id

     document
       .getElementById("AddArticleForm")
       .addEventListener("submit", (event) => {
         event.preventDefault();

         const title = document.getElementById("title").value;
         const content = CKEDITOR.instances.body.getData();
         const tag = document.getElementById("tag").value;

         var myHeaders = new Headers();
         myHeaders.append("Authorization", `Bearer ${user.token}`);
         myHeaders.append("Content-Type", "application/json");

         var raw = JSON.stringify({
           "title": title,
           "content": content
         });

         var requestOptions = {
           method: 'PATCH',
           headers: myHeaders,
           body: raw,
           redirect: 'follow'
         };

         fetch(`https://my-brand-app-api.herokuapp.com/api/articles/update/${id}`, requestOptions)
           .then(response => response.text())
           .then(result => console.log(result))
           .catch(error => console.log('error', error));


       });
   } else {

     const postForm = document.querySelector('[create-form]');

     document.getElementById("file").required = ""

     document
       .getElementById("AddArticleForm")
       .addEventListener("submit", (event) => {
         event.preventDefault();
         console.log('here')
         const title = document.getElementById("title").value;
         const body = CKEDITOR.instances.body.getData();
         const tag = document.getElementById("tag").value;
         const image = document.getElementById("file");
         var myHeaders = new Headers();
         myHeaders.append("Content-Type", "application/json");
         myHeaders.append("Authorization", `Bearer ${user.token}`);

         var formdata = new FormData();
         formdata.append("title", "this is testing blog article title 2");
         formdata.append("content", "this is testing blog article title content 2");
         // formdata.append("photo", image.files[0], "/C:/Users/ALU TECH TEAM/Desktop/55650162.jpg");

         var raw = JSON.stringify({
           "title": title,
           "content": body
         });

         var requestOptions = {
           method: 'POST',
           headers: myHeaders,
           body: raw,
           redirect: 'follow'
         };

         fetch("https://my-brand-app-api.herokuapp.com/api/articles/add", requestOptions)
           .then(response => response.json())
           .then(result => {
             console.log(result)
             window.open("./view-post.html", "_self");
           })
           .catch(error => console.log('error', error));;

         // window.open("./view-article.html", "_self");
         // console.log(file)
       });
   }
 </script>
</body>
</html>
